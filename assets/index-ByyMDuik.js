import{r as t,M as $,j as n,i as H,u as I,P as B,a as F,b as D,L as A,G as z,c as G,m as M,h as W}from"./index-B5gjWBKR.js";class X extends t.Component{getSnapshotBeforeUpdate(a){const s=this.props.childRef.current;if(s&&a.isPresent&&!this.props.isPresent){const r=s.offsetParent,l=H(r)&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=s.offsetHeight||0,i.width=s.offsetWidth||0,i.top=s.offsetTop,i.left=s.offsetLeft,i.right=l-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function K({children:e,isPresent:a,anchorX:s,root:r}){const l=t.useId(),i=t.useRef(null),u=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:C}=t.useContext($);return t.useInsertionEffect(()=>{const{width:o,height:d,top:b,left:f,right:p}=u.current;if(a||!i.current||!o||!d)return;const y=s==="left"?`left: ${f}`:`right: ${p}`;i.current.dataset.motionPopId=l;const m=document.createElement("style");C&&(m.nonce=C);const c=r??document.head;return c.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${l}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${d}px !important;
            ${y}px !important;
            top: ${b}px !important;
          }
        `),()=>{c.contains(m)&&c.removeChild(m)}},[a]),n.jsx(X,{isPresent:a,childRef:i,sizeRef:u,children:t.cloneElement(e,{ref:i})})}const U=({children:e,initial:a,isPresent:s,onExitComplete:r,custom:l,presenceAffectsLayout:i,mode:u,anchorX:C,root:o})=>{const d=I(Y),b=t.useId();let f=!0,p=t.useMemo(()=>(f=!1,{id:b,initial:a,isPresent:s,custom:l,onExitComplete:y=>{d.set(y,!0);for(const m of d.values())if(!m)return;r&&r()},register:y=>(d.set(y,!1),()=>d.delete(y))}),[s,d,r]);return i&&f&&(p={...p}),t.useMemo(()=>{d.forEach((y,m)=>d.set(m,!1))},[s]),t.useEffect(()=>{!s&&!d.size&&r&&r()},[s]),u==="popLayout"&&(e=n.jsx(K,{isPresent:s,anchorX:C,root:o,children:e})),n.jsx(B.Provider,{value:p,children:e})};function Y(){return new Map}const N=e=>e.key||"";function T(e){const a=[];return t.Children.forEach(e,s=>{t.isValidElement(s)&&a.push(s)}),a}const V=({children:e,custom:a,initial:s=!0,onExitComplete:r,presenceAffectsLayout:l=!0,mode:i="sync",propagate:u=!1,anchorX:C="left",root:o})=>{const[d,b]=F(u),f=t.useMemo(()=>T(e),[e]),p=u&&!d?[]:f.map(N),y=t.useRef(!0),m=t.useRef(f),c=I(()=>new Map),[g,E]=t.useState(f),[w,j]=t.useState(f);D(()=>{y.current=!1,m.current=f;for(let v=0;v<w.length;v++){const x=N(w[v]);p.includes(x)?c.delete(x):c.get(x)!==!0&&c.set(x,!1)}},[w,p.length,p.join("-")]);const h=[];if(f!==g){let v=[...f];for(let x=0;x<w.length;x++){const k=w[x],S=N(k);p.includes(S)||(v.splice(x,0,k),h.push(k))}return i==="wait"&&h.length&&(v=h),j(T(v)),E(f),null}const{forceRender:P}=t.useContext(A);return n.jsx(n.Fragment,{children:w.map(v=>{const x=N(v),k=u&&!d?!1:f===w||p.includes(x),S=()=>{if(c.has(x))c.set(x,!0);else return;let O=!0;c.forEach(L=>{L||(O=!1)}),O&&(P?.(),j(m.current),u&&b?.(),r&&r())};return n.jsx(U,{isPresent:k,initial:!y.current||s?void 0:!1,custom:a,presenceAffectsLayout:l,mode:i,root:o,onExitComplete:k?void 0:S,anchorX:C,children:v},x)})})};function _(e){return z({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"},child:[]}]})(e)}function q(e){return z({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(e)}function J(e){return z({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"},child:[]}]})(e)}function Q(e){return z({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"},child:[]}]})(e)}const Z=({slide:e,current:a,total:s,onPrev:r,onNext:l,isResetting:i})=>{const[u,C]=t.useState(!0),o=G(),[d,b]=t.useState(!0),f=t.useRef(null),[p,y]=t.useState(0);t.useEffect(()=>{i&&b(!1)},[i]),t.useEffect(()=>{i||b(!0)},[e.id,i]),t.useLayoutEffect(()=>{if(d&&f.current){const{height:h}=f.current.getBoundingClientRect();y(h)}},[e.id,d]);const m=t.useCallback(()=>{a>0&&(o.stop(),r())},[a,r,o]),c=t.useCallback(()=>{o.stop(),l()},[l,o]),g=t.useCallback(()=>{C(h=>!h)},[]),E=t.useMemo(()=>[{icon:n.jsx(J,{size:18}),onClick:m,disabled:a===0},{icon:u?n.jsx(_,{size:18}):n.jsx(q,{size:18}),onClick:g,disabled:!1},{icon:n.jsx(Q,{size:18}),onClick:c,disabled:!1}],[a,u]);t.useEffect(()=>{if(i){o.stop();return}if(o.set({width:0}),u){o.start({width:"100%",transition:{duration:5,ease:"linear"}});const h=window.setTimeout(l,5e3);return()=>{clearTimeout(h),o.stop()}}return()=>void o.stop()},[e.id,u,l,o,i]);const[w,j]=t.useMemo(()=>[String(a+1).padStart(2,"0"),String(s).padStart(2,"0")],[a,s]);return n.jsxs("div",{className:"flex flex-col items-center w-full max-w-lg px-4 sm:px-6 lg:px-8 mt-8",children:[n.jsx(M.div,{className:"inline-flex items-center space-x-4 bg-gray-100 dark:bg-[#1f1f1f] rounded-xl shadow-sm px-4 py-2",initial:!1,animate:{opacity:1,y:0},transition:{duration:.4},children:E.map((h,P)=>n.jsx(M.button,{onClick:h.disabled?void 0:h.onClick,disabled:h.disabled,whileHover:h.disabled?{}:{scale:1.15},whileTap:h.disabled?{}:{scale:.9},className:h.disabled?"p-3 bg-white dark:bg-[#24272b] rounded-full shadow-md focus:outline-none transition opacity-50":"p-3 bg-white dark:bg-[#24272b] rounded-full shadow-md hover:shadow-lg focus:outline-none transition cursor-pointer",children:n.jsx("span",{className:"text-gray-600 dark:text-gray-200",children:h.icon})},P))}),n.jsxs("div",{className:"w-full flex justify-between mt-4 mb-1 px-1",children:[n.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:w}),n.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:j})]}),n.jsx("div",{className:"w-full h-1 bg-gray-300 dark:bg-gray-600 rounded-full overflow-hidden",children:n.jsx(M.div,{animate:o,className:"h-full bg-blue-500 dark:bg-blue-400",style:{width:0}})}),n.jsx("div",{ref:f,className:"w-full mt-6 px-2 lg:px-4 py-4",style:{minHeight:p||void 0,overflow:"visible"},children:n.jsx(V,{mode:"wait",children:d&&n.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:"easeOut"},className:"flex flex-col items-center justify-center space-y-1",children:[n.jsx("h3",{className:"truncate text-xl sm:text-2xl md:text-3xl font-semibold text-gray-900 dark:text-white",children:e.title}),n.jsx("p",{className:"text-sm sm:text-base text-gray-500 dark:text-gray-400",children:e.period}),n.jsx("p",{className:"text-sm sm:text-base text-gray-700 dark:text-gray-300",children:e.tech})]},e.id)})})]})},ee=t.memo(Z),te=({card:e,index:a,isTop:s,onSwipe:r,dirRef:l})=>{const i=t.useCallback((C,o)=>{Math.abs(o.offset.x)>100&&(l.current=o.offset.x>0?1:-1,r())},[l,r]),u=t.useCallback(()=>{l.current=1,r()},[l,r]);return n.jsxs(M.div,{drag:s?"x":!1,dragConstraints:{left:0,right:0},onDragEnd:i,onTap:s?u:void 0,initial:{x:e.xOffset,y:e.yOffset+50,scale:.9,rotate:e.rotateOffset,opacity:0},animate:{x:e.xOffset,y:e.yOffset,scale:e.scale,rotate:e.rotateOffset,opacity:1,transition:{delay:a*.1,type:"spring",stiffness:200,damping:25}},exit:{x:e.xOffset+l.current*(Math.random()*200+100),y:e.yOffset-(Math.random()*50+50),rotate:e.rotateOffset+l.current*(Math.random()*20+10),opacity:0,transition:{duration:.4}},style:{zIndex:a},className:`absolute inset-0 rounded-xl overflow-hidden shadow-2xl cursor-pointer select-none ${e.contain?"bg-white":""}`,children:[n.jsx("img",{src:e.image,alt:e.title,loading:"lazy",className:`absolute inset-0 w-full h-full object-center ${e.contain?"object-contain":"object-fill"}`}),n.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-b from-black/5 via-black/10 to-black/15"})]})},se=t.memo(te),R=W.flatMap(e=>e.projects).reverse(),ne=()=>{const[e,a]=t.useState(R),[s,r]=t.useState([]),[l,i]=t.useState(!1),u=t.useRef(0),C=t.useRef({}),o=t.useMemo(()=>e.map((j,h)=>{C.current[j.id]||(C.current[j.id]={x:(Math.random()*2-1)*20,y:(Math.random()*2-1)*10,r:(Math.random()*2-1)*5});const{x:P,y:v,r:x}=C.current[j.id];return{...j,xOffset:P,yOffset:v,rotateOffset:x,scale:1-(e.length-1-h)*.01}}),[e]),d=t.useCallback(()=>{if(!e.length)return;const c=e[e.length-1];u.current=1,a(g=>g.slice(0,-1)),r(g=>[...g,c])},[e]),b=t.useCallback(()=>{if(!s.length)return;const c=s[s.length-1];u.current=-1,r(g=>g.slice(0,-1)),a(g=>[...g,c])},[s]);t.useEffect(()=>{if(e.length===0){i(!0);const c=window.setTimeout(()=>{a(R),r([]),i(!1)},1e3);return()=>clearTimeout(c)}},[e]);const f=R.length,p=s.length<f?s.length:0,y=e.length>0?e[e.length-1]:R[0],m={initial:{opacity:0,y:20},shrink:{opacity:1,y:0,transition:{duration:.5}}};return n.jsxs(M.div,{className:"flex-1 flex flex-col items-center justify-center gap-8 px-4",variants:m,initial:"initial",animate:"shrink",children:[n.jsx("div",{className:"relative w-[32rem] h-[26rem] sm:w-[36rem] sm:h-[28rem] md:w-[40rem] md:h-[30rem] lg:w-[44rem] lg:h-[32rem] max-w-[44rem] max-h-[32rem]",children:n.jsx(V,{initial:!1,children:o.map((c,g)=>n.jsx(se,{card:c,index:g,isTop:g===o.length-1,onSwipe:d,dirRef:u},c.id))})}),n.jsx(ee,{slide:y,current:p,total:f,onPrev:b,onNext:d,isResetting:l})]})},ae=t.memo(ne);export{ae as default};
